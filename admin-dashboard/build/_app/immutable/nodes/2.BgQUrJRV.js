import{S as we,i as $e,s as Ie,n as me,d,e as M,f as O,h as r,G as g,j as _,k as y,l as w,m as T,o as m,p as $,q as L,J as Te,K as Ve,L as X,z as Le,M as Et,t as ee,a as Q,v as pt,w as bt,x as Je,N as Dt,O as Ze,P as kt,Q as xt,R as wt,T as $t,C as de,E as he,F as ve,D as _e,U as et}from"../chunks/Cj5CJtXD.js";import"../chunks/IHki7fMi.js";function ge(n){return(n==null?void 0:n.length)!==void 0?n:Array.from(n)}const Se="https://gallant-reflection-production.up.railway.app/api/v1";async function yt(n,e={}){const l=await fetch(`${Se}${n}`,{...e,headers:{"Content-Type":"application/json",...e.headers||{}},credentials:"include"});if(!l.ok)throw new Error(`HTTP ${l.status}`);return l.json()}function It(n,e){const l=new EventSource(`${Se}${n}`,{withCredentials:!0});return l.onmessage=e,l}function Ct(n){let e,l,t,s,i,a=(n[1]??"–")+"",c;return{c(){e=m("div"),l=m("div"),t=$(n[0]),s=L(),i=m("div"),c=$(a),this.h()},l(o){e=_(o,"DIV",{class:!0});var u=y(e);l=_(u,"DIV",{class:!0});var h=y(l);t=w(h,n[0]),h.forEach(d),s=T(u),i=_(u,"DIV",{class:!0});var f=y(i);c=w(f,a),f.forEach(d),u.forEach(d),this.h()},h(){g(l,"class","text-sm text-gray-400"),g(i,"class","mt-1 text-3xl font-semibold"),g(e,"class","glass rounded-xl p-4")},m(o,u){O(o,e,u),r(e,l),r(l,t),r(e,s),r(e,i),r(i,c)},p(o,[u]){u&1&&M(t,o[0]),u&2&&a!==(a=(o[1]??"–")+"")&&M(c,a)},i:me,o:me,d(o){o&&d(e)}}}function Vt(n,e,l){let{title:t}=e,{value:s}=e;return n.$$set=i=>{"title"in i&&l(0,t=i.title),"value"in i&&l(1,s=i.value)},[t,s]}class xe extends we{constructor(e){super(),$e(this,e,Vt,Ct,Ie,{title:0,value:1})}}function tt(n,e,l){const t=n.slice();return t[6]=e[l],t}function lt(n){let e,l;return{c(){e=m("div"),l=$(n[1]),this.h()},l(t){e=_(t,"DIV",{class:!0});var s=y(e);l=w(s,n[1]),s.forEach(d),this.h()},h(){g(e,"class","p-3 text-red-400 text-sm")},m(t,s){O(t,e,s),r(e,l)},p(t,s){s&2&&M(l,t[1])},d(t){t&&d(e)}}}function st(n){let e,l,t,s=n[6].ts+"",i,a,c,o,u=n[6].level+"",h,f,D,x,p=n[6].name+"",v,k,R,b=n[6].message+"",P,U;return{c(){e=m("div"),l=m("span"),t=$("["),i=$(s),a=$("]"),c=L(),o=m("span"),h=$(u),D=L(),x=m("span"),v=$(p),k=L(),R=m("span"),P=$(b),U=L(),this.h()},l(V){e=_(V,"DIV",{class:!0});var C=y(e);l=_(C,"SPAN",{class:!0});var N=y(l);t=w(N,"["),i=w(N,s),a=w(N,"]"),N.forEach(d),c=T(C),o=_(C,"SPAN",{class:!0});var q=y(o);h=w(q,u),q.forEach(d),D=T(C),x=_(C,"SPAN",{class:!0});var E=y(x);v=w(E,p),E.forEach(d),k=T(C),R=_(C,"SPAN",{class:!0});var I=y(R);P=w(I,b),I.forEach(d),U=T(C),C.forEach(d),this.h()},h(){g(l,"class","text-gray-500"),g(o,"class",f="ml-1 font-semibold "+(n[6].level==="ERROR"?"text-red-400":n[6].level==="WARNING"?"text-yellow-400":"text-green-400")),g(x,"class","ml-1 text-gray-400"),g(R,"class","ml-2"),g(e,"class","px-3 py-1 whitespace-pre-wrap")},m(V,C){O(V,e,C),r(e,l),r(l,t),r(l,i),r(l,a),r(e,c),r(e,o),r(o,h),r(e,D),r(e,x),r(x,v),r(e,k),r(e,R),r(R,P),r(e,U)},p(V,C){C&1&&s!==(s=V[6].ts+"")&&M(i,s),C&1&&u!==(u=V[6].level+"")&&M(h,u),C&1&&f!==(f="ml-1 font-semibold "+(V[6].level==="ERROR"?"text-red-400":V[6].level==="WARNING"?"text-yellow-400":"text-green-400"))&&g(o,"class",f),C&1&&p!==(p=V[6].name+"")&&M(v,p),C&1&&b!==(b=V[6].message+"")&&M(P,b)},d(V){V&&d(e)}}}function St(n){let e,l,t,s="Recent Logs",i,a,c="Refresh",o,u,h,f,D,x=n[1]&&lt(n),p=ge(n[0]),v=[];for(let k=0;k<p.length;k+=1)v[k]=st(tt(n,p,k));return{c(){e=m("div"),l=m("div"),t=m("div"),t.textContent=s,i=L(),a=m("button"),a.textContent=c,o=L(),x&&x.c(),u=L(),h=m("div");for(let k=0;k<v.length;k+=1)v[k].c();this.h()},l(k){e=_(k,"DIV",{class:!0});var R=y(e);l=_(R,"DIV",{class:!0});var b=y(l);t=_(b,"DIV",{class:!0,"data-svelte-h":!0}),X(t)!=="svelte-64tdm0"&&(t.textContent=s),i=T(b),a=_(b,"BUTTON",{class:!0,"data-svelte-h":!0}),X(a)!=="svelte-9svlmm"&&(a.textContent=c),b.forEach(d),o=T(R),x&&x.l(R),u=T(R),h=_(R,"DIV",{class:!0});var P=y(h);for(let U=0;U<v.length;U+=1)v[U].l(P);P.forEach(d),R.forEach(d),this.h()},h(){g(t,"class","text-sm font-semibold"),g(a,"class","text-xs text-blue-400 hover:underline"),g(l,"class","flex items-center justify-between px-3 py-2 border-b border-gray-700"),g(h,"class","max-h-64 overflow-auto text-xs"),g(e,"class","rounded-lg border border-gray-700 bg-gray-900/60")},m(k,R){O(k,e,R),r(e,l),r(l,t),r(l,i),r(l,a),r(e,o),x&&x.m(e,null),r(e,u),r(e,h);for(let b=0;b<v.length;b+=1)v[b]&&v[b].m(h,null);f||(D=Ve(a,"click",n[2]),f=!0)},p(k,[R]){if(k[1]?x?x.p(k,R):(x=lt(k),x.c(),x.m(e,u)):x&&(x.d(1),x=null),R&1){p=ge(k[0]);let b;for(b=0;b<p.length;b+=1){const P=tt(k,p,b);v[b]?v[b].p(P,R):(v[b]=st(P),v[b].c(),v[b].m(h,null))}for(;b<v.length;b+=1)v[b].d(1);v.length=p.length}},i:me,o:me,d(k){k&&d(e),x&&x.d(),Te(v,k),f=!1,D()}}}function Tt(n,e,l){let{pollMs:t=3e3}=e,{max:s=200}=e,{level:i}=e,a=[],c=null;async function o(){try{const u=new URLSearchParams;u.set("limit",String(s)),i&&u.set("level",i);const h=await fetch(`${Se}/analytics/logs?${u.toString()}`,{credentials:"include"});if(!h.ok)throw new Error(`HTTP ${h.status}`);l(0,a=await h.json()),l(1,c=null)}catch(u){l(1,c=u.message)}}return Le(()=>{o();const u=setInterval(o,t);return()=>clearInterval(u)}),n.$$set=u=>{"pollMs"in u&&l(3,t=u.pollMs),"max"in u&&l(4,s=u.max),"level"in u&&l(5,i=u.level)},[a,c,o,t,s,i]}class Lt extends we{constructor(e){super(),$e(this,e,Tt,St,Ie,{pollMs:3,max:4,level:5})}}function nt(n,{delay:e=0,duration:l=400,easing:t=Et}={}){const s=+getComputedStyle(n).opacity;return{delay:e,duration:l,easing:t,css:i=>`opacity: ${i*s}`}}function at(n,e,l){const t=n.slice();return t[7]=e[l],t}function rt(n,e,l){const t=n.slice();return t[10]=e[l],t}function it(n,e,l){const t=n.slice();return t[13]=e[l],t}function ot(n){let e,l,t,s="×",i,a,c,o=n[0].session.session_id+"",u,h,f,D,x,p="Metadata",v,k,R,b=JSON.stringify(n[0].session,null,2)+"",P,U,V,C,N,q,E=n[0].metrics.length+"",I,A,j,S,J,z,G,pe,te=n[0].events.length+"",ce,ye,H,F,Z,B,Y,se,ne=n[0].logs.length+"",be,Ee,De,fe,ae,le,ke,Ce;function Ge(W,K){return W[0].metrics.length===0?Rt:Nt}let Ne=Ge(n),re=Ne(n);function We(W,K){return W[0].events.length===0?At:qt}let Re=We(n),ie=Re(n);function Ye(W,K){return W[0].logs.length===0?Pt:Ht}let qe=Ye(n),oe=qe(n);return{c(){e=m("div"),l=m("div"),t=m("button"),t.textContent=s,i=L(),a=m("h2"),c=$("Session "),u=$(o),h=L(),f=m("div"),D=m("div"),x=m("h3"),x.textContent=p,v=L(),k=m("pre"),R=$("            "),P=$(b),U=$(`
          `),V=L(),C=m("div"),N=m("h3"),q=$("Metrics ("),I=$(E),A=$(")"),j=L(),S=m("div"),re.c(),J=L(),z=m("div"),G=m("h3"),pe=$("Events ("),ce=$(te),ye=$(")"),H=L(),F=m("div"),ie.c(),Z=L(),B=m("div"),Y=m("h3"),se=$("Error Logs ("),be=$(ne),Ee=$(")"),De=L(),fe=m("div"),oe.c(),this.h()},l(W){e=_(W,"DIV",{class:!0});var K=y(e);l=_(K,"DIV",{class:!0});var ue=y(l);t=_(ue,"BUTTON",{class:!0,"data-svelte-h":!0}),X(t)!=="svelte-1cvpj9k"&&(t.textContent=s),i=T(ue),a=_(ue,"H2",{class:!0});var Fe=y(a);c=w(Fe,"Session "),u=w(Fe,o),Fe.forEach(d),h=T(ue),f=_(ue,"DIV",{class:!0});var Ae=y(f);D=_(Ae,"DIV",{});var He=y(D);x=_(He,"H3",{class:!0,"data-svelte-h":!0}),X(x)!=="svelte-ps61nb"&&(x.textContent=p),v=T(He),k=_(He,"PRE",{class:!0});var Pe=y(k);R=w(Pe,"            "),P=w(Pe,b),U=w(Pe,`
          `),Pe.forEach(d),He.forEach(d),V=T(Ae),C=_(Ae,"DIV",{});var Me=y(C);N=_(Me,"H3",{class:!0});var Ue=y(N);q=w(Ue,"Metrics ("),I=w(Ue,E),A=w(Ue,")"),Ue.forEach(d),j=T(Me),S=_(Me,"DIV",{class:!0});var Ke=y(S);re.l(Ke),Ke.forEach(d),Me.forEach(d),Ae.forEach(d),J=T(ue),z=_(ue,"DIV",{class:!0});var je=y(z);G=_(je,"H3",{class:!0});var Oe=y(G);pe=w(Oe,"Events ("),ce=w(Oe,te),ye=w(Oe,")"),Oe.forEach(d),H=T(je),F=_(je,"DIV",{class:!0});var Qe=y(F);ie.l(Qe),Qe.forEach(d),je.forEach(d),Z=T(ue),B=_(ue,"DIV",{});var ze=y(B);Y=_(ze,"H3",{class:!0});var Be=y(Y);se=w(Be,"Error Logs ("),be=w(Be,ne),Ee=w(Be,")"),Be.forEach(d),De=T(ze),fe=_(ze,"DIV",{class:!0});var Xe=y(fe);oe.l(Xe),Xe.forEach(d),ze.forEach(d),ue.forEach(d),K.forEach(d),this.h()},h(){g(t,"class","close-button absolute top-3 right-3 text-gray-600 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-200 svelte-iyxvrs"),g(a,"class","text-lg font-semibold mb-2 text-gray-900 dark:text-white"),g(x,"class","text-sm font-medium text-gray-700 dark:text-gray-300"),g(k,"class","text-xs font-mono bg-gray-100 dark:bg-gray-800 p-2 rounded mt-2 overflow-auto max-h-32 text-gray-800 dark:text-gray-200"),g(N,"class","text-sm font-medium text-gray-700 dark:text-gray-300"),g(S,"class","mt-2 max-h-32 overflow-auto text-xs"),g(f,"class","grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"),g(G,"class","text-sm font-medium text-gray-700 dark:text-gray-300"),g(F,"class","mt-2 max-h-48 overflow-auto text-xs font-mono bg-gray-50 dark:bg-gray-800 p-2 rounded text-gray-800 dark:text-gray-200"),g(z,"class","mb-4"),g(Y,"class","text-sm font-medium text-gray-700 dark:text-gray-300"),g(fe,"class","mt-2 max-h-48 overflow-auto text-xs font-mono bg-gray-50 dark:bg-gray-800 p-2 rounded"),g(l,"class","modal-content bg-white dark:bg-gray-900 rounded-lg shadow-lg w-11/12 max-w-3xl p-4 max-h-[90vh] overflow-auto"),g(e,"class","modal-backdrop fixed inset-0 bg-black/50 flex items-center justify-center z-50")},m(W,K){O(W,e,K),r(e,l),r(l,t),r(l,i),r(l,a),r(a,c),r(a,u),r(l,h),r(l,f),r(f,D),r(D,x),r(D,v),r(D,k),r(k,R),r(k,P),r(k,U),r(f,V),r(f,C),r(C,N),r(N,q),r(N,I),r(N,A),r(C,j),r(C,S),re.m(S,null),r(l,J),r(l,z),r(z,G),r(G,pe),r(G,ce),r(G,ye),r(z,H),r(z,F),ie.m(F,null),r(l,Z),r(l,B),r(B,Y),r(Y,se),r(Y,be),r(Y,Ee),r(B,De),r(B,fe),oe.m(fe,null),le=!0,ke||(Ce=[Ve(t,"click",function(){xt(n[1])&&n[1].apply(this,arguments)}),Ve(l,"click",wt(n[2]))],ke=!0)},p(W,K){n=W,(!le||K&1)&&o!==(o=n[0].session.session_id+"")&&M(u,o),(!le||K&1)&&b!==(b=JSON.stringify(n[0].session,null,2)+"")&&M(P,b),(!le||K&1)&&E!==(E=n[0].metrics.length+"")&&M(I,E),Ne===(Ne=Ge(n))&&re?re.p(n,K):(re.d(1),re=Ne(n),re&&(re.c(),re.m(S,null))),(!le||K&1)&&te!==(te=n[0].events.length+"")&&M(ce,te),Re===(Re=We(n))&&ie?ie.p(n,K):(ie.d(1),ie=Re(n),ie&&(ie.c(),ie.m(F,null))),(!le||K&1)&&ne!==(ne=n[0].logs.length+"")&&M(be,ne),qe===(qe=Ye(n))&&oe?oe.p(n,K):(oe.d(1),oe=qe(n),oe&&(oe.c(),oe.m(fe,null)))},i(W){le||(W&&kt(()=>{le&&(ae||(ae=Ze(e,nt,{},!0)),ae.run(1))}),le=!0)},o(W){W&&(ae||(ae=Ze(e,nt,{},!1)),ae.run(0)),le=!1},d(W){W&&d(e),re.d(),ie.d(),oe.d(),W&&ae&&ae.end(),ke=!1,Dt(Ce)}}}function Nt(n){let e,l=ge(n[0].metrics),t=[];for(let s=0;s<l.length;s+=1)t[s]=ct(it(n,l,s));return{c(){e=m("ul");for(let s=0;s<t.length;s+=1)t[s].c();this.h()},l(s){e=_(s,"UL",{class:!0});var i=y(e);for(let a=0;a<t.length;a+=1)t[a].l(i);i.forEach(d),this.h()},h(){g(e,"class","space-y-1")},m(s,i){O(s,e,i);for(let a=0;a<t.length;a+=1)t[a]&&t[a].m(e,null)},p(s,i){if(i&1){l=ge(s[0].metrics);let a;for(a=0;a<l.length;a+=1){const c=it(s,l,a);t[a]?t[a].p(c,i):(t[a]=ct(c),t[a].c(),t[a].m(e,null))}for(;a<t.length;a+=1)t[a].d(1);t.length=l.length}},d(s){s&&d(e),Te(t,s)}}}function Rt(n){let e,l="No metrics";return{c(){e=m("div"),e.textContent=l,this.h()},l(t){e=_(t,"DIV",{class:!0,"data-svelte-h":!0}),X(e)!=="svelte-r7yzz2"&&(e.textContent=l),this.h()},h(){g(e,"class","text-gray-500")},m(t,s){O(t,e,s)},p:me,d(t){t&&d(e)}}}function ct(n){let e,l=n[13].metric_name+"",t,s,i=n[13].metric_value+"",a,c,o=(n[13].metric_unit||"")+"",u;return{c(){e=m("li"),t=$(l),s=$(": "),a=$(i),c=L(),u=$(o),this.h()},l(h){e=_(h,"LI",{class:!0});var f=y(e);t=w(f,l),s=w(f,": "),a=w(f,i),c=T(f),u=w(f,o),f.forEach(d),this.h()},h(){g(e,"class","py-1")},m(h,f){O(h,e,f),r(e,t),r(e,s),r(e,a),r(e,c),r(e,u)},p(h,f){f&1&&l!==(l=h[13].metric_name+"")&&M(t,l),f&1&&i!==(i=h[13].metric_value+"")&&M(a,i),f&1&&o!==(o=(h[13].metric_unit||"")+"")&&M(u,o)},d(h){h&&d(e)}}}function qt(n){let e,l=ge(n[0].events),t=[];for(let s=0;s<l.length;s+=1)t[s]=ft(rt(n,l,s));return{c(){e=m("ul");for(let s=0;s<t.length;s+=1)t[s].c();this.h()},l(s){e=_(s,"UL",{class:!0});var i=y(e);for(let a=0;a<t.length;a+=1)t[a].l(i);i.forEach(d),this.h()},h(){g(e,"class","space-y-1")},m(s,i){O(s,e,i);for(let a=0;a<t.length;a+=1)t[a]&&t[a].m(e,null)},p(s,i){if(i&1){l=ge(s[0].events);let a;for(a=0;a<l.length;a+=1){const c=rt(s,l,a);t[a]?t[a].p(c,i):(t[a]=ft(c),t[a].c(),t[a].m(e,null))}for(;a<t.length;a+=1)t[a].d(1);t.length=l.length}},d(s){s&&d(e),Te(t,s)}}}function At(n){let e,l="No events";return{c(){e=m("div"),e.textContent=l,this.h()},l(t){e=_(t,"DIV",{class:!0,"data-svelte-h":!0}),X(e)!=="svelte-6yi49y"&&(e.textContent=l),this.h()},h(){g(e,"class","text-gray-500")},m(t,s){O(t,e,s)},p:me,d(t){t&&d(e)}}}function ft(n){let e,l=new Date(n[10].timestamp).toLocaleString()+"",t,s,i=n[10].event_type+"",a,c,o=(n[10].tool_name||"")+"",u,h,f=(n[10].response_time_ms??"-")+"",D,x;return{c(){e=m("li"),t=$(l),s=$(" — "),a=$(i),c=$(" — "),u=$(o),h=$(" — "),D=$(f),x=$(`ms
                `),this.h()},l(p){e=_(p,"LI",{class:!0});var v=y(e);t=w(v,l),s=w(v," — "),a=w(v,i),c=w(v," — "),u=w(v,o),h=w(v," — "),D=w(v,f),x=w(v,`ms
                `),v.forEach(d),this.h()},h(){g(e,"class","py-1")},m(p,v){O(p,e,v),r(e,t),r(e,s),r(e,a),r(e,c),r(e,u),r(e,h),r(e,D),r(e,x)},p(p,v){v&1&&l!==(l=new Date(p[10].timestamp).toLocaleString()+"")&&M(t,l),v&1&&i!==(i=p[10].event_type+"")&&M(a,i),v&1&&o!==(o=(p[10].tool_name||"")+"")&&M(u,o),v&1&&f!==(f=(p[10].response_time_ms??"-")+"")&&M(D,f)},d(p){p&&d(e)}}}function Ht(n){let e,l=ge(n[0].logs),t=[];for(let s=0;s<l.length;s+=1)t[s]=ut(at(n,l,s));return{c(){e=m("ul");for(let s=0;s<t.length;s+=1)t[s].c();this.h()},l(s){e=_(s,"UL",{class:!0});var i=y(e);for(let a=0;a<t.length;a+=1)t[a].l(i);i.forEach(d),this.h()},h(){g(e,"class","space-y-1")},m(s,i){O(s,e,i);for(let a=0;a<t.length;a+=1)t[a]&&t[a].m(e,null)},p(s,i){if(i&1){l=ge(s[0].logs);let a;for(a=0;a<l.length;a+=1){const c=at(s,l,a);t[a]?t[a].p(c,i):(t[a]=ut(c),t[a].c(),t[a].m(e,null))}for(;a<t.length;a+=1)t[a].d(1);t.length=l.length}},d(s){s&&d(e),Te(t,s)}}}function Pt(n){let e,l="No logs";return{c(){e=m("div"),e.textContent=l,this.h()},l(t){e=_(t,"DIV",{class:!0,"data-svelte-h":!0}),X(e)!=="svelte-1ma6z1c"&&(e.textContent=l),this.h()},h(){g(e,"class","text-gray-500")},m(t,s){O(t,e,s)},p:me,d(t){t&&d(e)}}}function ut(n){let e,l=new Date(n[7].timestamp).toLocaleString()+"",t,s,i=n[7].level+"",a,c,o=n[7].error_type+"",u,h,f=n[7].error_message+"",D,x;return{c(){e=m("li"),t=$(l),s=$(" ["),a=$(i),c=$("] — "),u=$(o),h=$(": "),D=$(f),x=L(),this.h()},l(p){e=_(p,"LI",{class:!0});var v=y(e);t=w(v,l),s=w(v," ["),a=w(v,i),c=w(v,"] — "),u=w(v,o),h=w(v,": "),D=w(v,f),x=T(v),v.forEach(d),this.h()},h(){g(e,"class","py-1")},m(p,v){O(p,e,v),r(e,t),r(e,s),r(e,a),r(e,c),r(e,u),r(e,h),r(e,D),r(e,x)},p(p,v){v&1&&l!==(l=new Date(p[7].timestamp).toLocaleString()+"")&&M(t,l),v&1&&i!==(i=p[7].level+"")&&M(a,i),v&1&&o!==(o=p[7].error_type+"")&&M(u,o),v&1&&f!==(f=p[7].error_message+"")&&M(D,f)},d(p){p&&d(e)}}}function Mt(n){let e,l=n[0]&&ot(n);return{c(){l&&l.c(),e=Je()},l(t){l&&l.l(t),e=Je()},m(t,s){l&&l.m(t,s),O(t,e,s)},p(t,[s]){t[0]?l?(l.p(t,s),s&1&&Q(l,1)):(l=ot(t),l.c(),Q(l,1),l.m(e.parentNode,e)):l&&(pt(),ee(l,1,1,()=>{l=null}),bt())},i(t){Q(l)},o(t){ee(l)},d(t){t&&d(e),l&&l.d(t)}}}function Ut(n,e,l){let{sessionDetail:t=null}=e,{onClose:s=()=>{}}=e,i;const a=5*60*1e3;function c(){clearTimeout(i),i=setTimeout(()=>{s()},a)}function o(){c()}Le(()=>{c();const h=["mousemove","keydown","click","touchstart","scroll"];return h.forEach(f=>{document.addEventListener(f,o)}),()=>{clearTimeout(i),h.forEach(f=>{document.removeEventListener(f,o)})}});function u(h){$t.call(this,n,h)}return n.$$set=h=>{"sessionDetail"in h&&l(0,t=h.sessionDetail),"onClose"in h&&l(1,s=h.onClose)},[t,s,u]}class jt extends we{constructor(e){super(),$e(this,e,Ut,Mt,Ie,{sessionDetail:0,onClose:1})}}function dt(n,e,l){const t=n.slice();return t[8]=e[l],t}function ht(n){let e,l;return{c(){e=m("div"),l=$(n[1]),this.h()},l(t){e=_(t,"DIV",{class:!0});var s=y(e);l=w(s,n[1]),s.forEach(d),this.h()},h(){g(e,"class","p-3 text-red-400 text-sm")},m(t,s){O(t,e,s),r(e,l)},p(t,s){s&2&&M(l,t[1])},d(t){t&&d(e)}}}function vt(n){let e,l,t=n[8].session_id+"",s,i,a,c=new Date(n[8].created_at).toLocaleString()+"",o,u,h,f=n[8].total_requests+"",D,x,p,v=n[8].total_errors+"",k,R,b,P=n[8].total_processing_time_ms+"",U,V,C,N;function q(){return n[7](n[8])}return{c(){e=m("tr"),l=m("td"),s=$(t),i=L(),a=m("td"),o=$(c),u=L(),h=m("td"),D=$(f),x=L(),p=m("td"),k=$(v),R=L(),b=m("td"),U=$(P),V=L(),this.h()},l(E){e=_(E,"TR",{class:!0});var I=y(e);l=_(I,"TD",{class:!0});var A=y(l);s=w(A,t),A.forEach(d),i=T(I),a=_(I,"TD",{class:!0});var j=y(a);o=w(j,c),j.forEach(d),u=T(I),h=_(I,"TD",{class:!0});var S=y(h);D=w(S,f),S.forEach(d),x=T(I),p=_(I,"TD",{class:!0});var J=y(p);k=w(J,v),J.forEach(d),R=T(I),b=_(I,"TD",{class:!0});var z=y(b);U=w(z,P),z.forEach(d),V=T(I),I.forEach(d),this.h()},h(){g(l,"class","px-3 py-2 font-mono"),g(a,"class","px-3 py-2"),g(h,"class","px-3 py-2"),g(p,"class","px-3 py-2"),g(b,"class","px-3 py-2"),g(e,"class","border-t border-gray-800 hover:bg-gray-800/40 cursor-pointer")},m(E,I){O(E,e,I),r(e,l),r(l,s),r(e,i),r(e,a),r(a,o),r(e,u),r(e,h),r(h,D),r(e,x),r(e,p),r(p,k),r(e,R),r(e,b),r(b,U),r(e,V),C||(N=Ve(e,"click",q),C=!0)},p(E,I){n=E,I&1&&t!==(t=n[8].session_id+"")&&M(s,t),I&1&&c!==(c=new Date(n[8].created_at).toLocaleString()+"")&&M(o,c),I&1&&f!==(f=n[8].total_requests+"")&&M(D,f),I&1&&v!==(v=n[8].total_errors+"")&&M(k,v),I&1&&P!==(P=n[8].total_processing_time_ms+"")&&M(U,P)},d(E){E&&d(e),C=!1,N()}}}function _t(n){let e,l;return e=new jt({props:{sessionDetail:n[2],onClose:n[4]}}),{c(){_e(e.$$.fragment)},l(t){ve(e.$$.fragment,t)},m(t,s){he(e,t,s),l=!0},p(t,s){const i={};s&4&&(i.sessionDetail=t[2]),e.$set(i)},i(t){l||(Q(e.$$.fragment,t),l=!0)},o(t){ee(e.$$.fragment,t),l=!1},d(t){de(e,t)}}}function Ot(n){let e,l,t,s="Recent Sessions",i,a,c="Refresh",o,u,h,f,D,x='<tr><th class="px-3 py-2">Session</th> <th class="px-3 py-2">Created</th> <th class="px-3 py-2">Requests</th> <th class="px-3 py-2">Errors</th> <th class="px-3 py-2">Proc (ms)</th></tr>',p,v,k,R,b,P,U,V=n[1]&&ht(n),C=ge(n[0]),N=[];for(let E=0;E<C.length;E+=1)N[E]=vt(dt(n,C,E));let q=n[2]&&_t(n);return{c(){e=m("div"),l=m("div"),t=m("div"),t.textContent=s,i=L(),a=m("button"),a.textContent=c,o=L(),V&&V.c(),u=L(),h=m("div"),f=m("table"),D=m("thead"),D.innerHTML=x,p=L(),v=m("tbody");for(let E=0;E<N.length;E+=1)N[E].c();k=L(),q&&q.c(),R=Je(),this.h()},l(E){e=_(E,"DIV",{class:!0});var I=y(e);l=_(I,"DIV",{class:!0});var A=y(l);t=_(A,"DIV",{class:!0,"data-svelte-h":!0}),X(t)!=="svelte-1d3eqnm"&&(t.textContent=s),i=T(A),a=_(A,"BUTTON",{class:!0,"data-svelte-h":!0}),X(a)!=="svelte-9svlmm"&&(a.textContent=c),A.forEach(d),o=T(I),V&&V.l(I),u=T(I),h=_(I,"DIV",{class:!0});var j=y(h);f=_(j,"TABLE",{class:!0});var S=y(f);D=_(S,"THEAD",{class:!0,"data-svelte-h":!0}),X(D)!=="svelte-1dstrq3"&&(D.innerHTML=x),p=T(S),v=_(S,"TBODY",{});var J=y(v);for(let z=0;z<N.length;z+=1)N[z].l(J);J.forEach(d),S.forEach(d),j.forEach(d),I.forEach(d),k=T(E),q&&q.l(E),R=Je(),this.h()},h(){g(t,"class","text-sm font-semibold"),g(a,"class","text-xs text-blue-400 hover:underline"),g(l,"class","flex items-center justify-between px-3 py-2 border-b border-gray-700"),g(D,"class","bg-gray-800 text-gray-300"),g(f,"class","min-w-full text-left text-xs"),g(h,"class","overflow-auto"),g(e,"class","rounded-lg border border-gray-700 bg-gray-900/60")},m(E,I){O(E,e,I),r(e,l),r(l,t),r(l,i),r(l,a),r(e,o),V&&V.m(e,null),r(e,u),r(e,h),r(h,f),r(f,D),r(f,p),r(f,v);for(let A=0;A<N.length;A+=1)N[A]&&N[A].m(v,null);O(E,k,I),q&&q.m(E,I),O(E,R,I),b=!0,P||(U=Ve(a,"click",n[5]),P=!0)},p(E,[I]){if(E[1]?V?V.p(E,I):(V=ht(E),V.c(),V.m(e,u)):V&&(V.d(1),V=null),I&9){C=ge(E[0]);let A;for(A=0;A<C.length;A+=1){const j=dt(E,C,A);N[A]?N[A].p(j,I):(N[A]=vt(j),N[A].c(),N[A].m(v,null))}for(;A<N.length;A+=1)N[A].d(1);N.length=C.length}E[2]?q?(q.p(E,I),I&4&&Q(q,1)):(q=_t(E),q.c(),Q(q,1),q.m(R.parentNode,R)):q&&(pt(),ee(q,1,1,()=>{q=null}),bt())},i(E){b||(Q(q),b=!0)},o(E){ee(q),b=!1},d(E){E&&(d(e),d(k),d(R)),V&&V.d(),Te(N,E),q&&q.d(E),P=!1,U()}}}function zt(n,e,l){let{pageSize:t=20}=e,s=[],i=null,a=null;async function c(f){try{const D=await fetch(`${Se}/analytics/sessions/${f}`);if(!D.ok)throw new Error(`HTTP ${D.status}`);l(2,a=await D.json())}catch(D){l(1,i=D.message)}}function o(){l(2,a=null)}async function u(){try{const f=new URLSearchParams;f.set("limit",String(t));const D=await fetch(`${Se}/analytics/sessions?${f.toString()}`,{credentials:"include"});if(!D.ok)throw new Error(`HTTP ${D.status}`);l(0,s=await D.json()),l(1,i=null)}catch(f){l(1,i=f.message)}}Le(()=>{u()});const h=f=>c(f.session_id);return n.$$set=f=>{"pageSize"in f&&l(6,t=f.pageSize)},[s,i,a,c,o,u,t,h]}class Bt extends we{constructor(e){super(),$e(this,e,zt,Ot,Ie,{pageSize:6})}}function Jt(n){var E,I,A;let e,l,t,s="Total Cost (USD)",i,a,c=mt(((E=n[0])==null?void 0:E.total_cost_usd)??0)+"",o,u,h,f,D="Total Tokens",x,p,v=(((I=n[0])==null?void 0:I.total_tokens)??0)+"",k,R,b,P,U="Total Requests",V,C,N=(((A=n[0])==null?void 0:A.total_requests)??0)+"",q;return{c(){e=m("div"),l=m("div"),t=m("div"),t.textContent=s,i=L(),a=m("div"),o=$(c),u=L(),h=m("div"),f=m("div"),f.textContent=D,x=L(),p=m("div"),k=$(v),R=L(),b=m("div"),P=m("div"),P.textContent=U,V=L(),C=m("div"),q=$(N),this.h()},l(j){e=_(j,"DIV",{class:!0});var S=y(e);l=_(S,"DIV",{class:!0});var J=y(l);t=_(J,"DIV",{class:!0,"data-svelte-h":!0}),X(t)!=="svelte-4hvilg"&&(t.textContent=s),i=T(J),a=_(J,"DIV",{class:!0});var z=y(a);o=w(z,c),z.forEach(d),J.forEach(d),u=T(S),h=_(S,"DIV",{class:!0});var G=y(h);f=_(G,"DIV",{class:!0,"data-svelte-h":!0}),X(f)!=="svelte-1an7ec4"&&(f.textContent=D),x=T(G),p=_(G,"DIV",{class:!0});var pe=y(p);k=w(pe,v),pe.forEach(d),G.forEach(d),R=T(S),b=_(S,"DIV",{class:!0});var te=y(b);P=_(te,"DIV",{class:!0,"data-svelte-h":!0}),X(P)!=="svelte-1sosej4"&&(P.textContent=U),V=T(te),C=_(te,"DIV",{class:!0});var ce=y(C);q=w(ce,N),ce.forEach(d),te.forEach(d),S.forEach(d),this.h()},h(){g(t,"class","text-xs text-gray-400"),g(a,"class","mt-1 text-2xl font-semibold"),g(l,"class","p-3 bg-gray-800/40 rounded"),g(f,"class","text-xs text-gray-400"),g(p,"class","mt-1 text-2xl font-semibold"),g(h,"class","p-3 bg-gray-800/40 rounded"),g(P,"class","text-xs text-gray-400"),g(C,"class","mt-1 text-2xl font-semibold"),g(b,"class","p-3 bg-gray-800/40 rounded"),g(e,"class","mt-4 grid grid-cols-1 sm:grid-cols-3 gap-4")},m(j,S){O(j,e,S),r(e,l),r(l,t),r(l,i),r(l,a),r(a,o),r(e,u),r(e,h),r(h,f),r(h,x),r(h,p),r(p,k),r(e,R),r(e,b),r(b,P),r(b,V),r(b,C),r(C,q)},p(j,S){var J,z,G;S&1&&c!==(c=mt(((J=j[0])==null?void 0:J.total_cost_usd)??0)+"")&&M(o,c),S&1&&v!==(v=(((z=j[0])==null?void 0:z.total_tokens)??0)+"")&&M(k,v),S&1&&N!==(N=(((G=j[0])==null?void 0:G.total_requests)??0)+"")&&M(q,N)},d(j){j&&d(e)}}}function Ft(n){let e,l,t;return{c(){e=m("div"),l=$("Error: "),t=$(n[1]),this.h()},l(s){e=_(s,"DIV",{class:!0});var i=y(e);l=w(i,"Error: "),t=w(i,n[1]),i.forEach(d),this.h()},h(){g(e,"class","mt-4 text-sm text-red-400")},m(s,i){O(s,e,i),r(e,l),r(e,t)},p(s,i){i&2&&M(t,s[1])},d(s){s&&d(e)}}}function Gt(n){let e,l="Loading…";return{c(){e=m("div"),e.textContent=l,this.h()},l(t){e=_(t,"DIV",{class:!0,"data-svelte-h":!0}),X(e)!=="svelte-1qhj9eb"&&(e.textContent=l),this.h()},h(){g(e,"class","mt-4 text-sm text-gray-400")},m(t,s){O(t,e,s)},p:me,d(t){t&&d(e)}}}function Wt(n){let e,l,t='<div><div class="text-sm text-gray-400">Cost Summary</div> <div class="mt-1 text-lg font-semibold">Overview (period)</div></div>',s;function i(o,u){return o[2]?Gt:o[1]?Ft:Jt}let a=i(n),c=a(n);return{c(){e=m("div"),l=m("div"),l.innerHTML=t,s=L(),c.c(),this.h()},l(o){e=_(o,"DIV",{class:!0});var u=y(e);l=_(u,"DIV",{class:!0,"data-svelte-h":!0}),X(l)!=="svelte-1uqmwdx"&&(l.innerHTML=t),s=T(u),c.l(u),u.forEach(d),this.h()},h(){g(l,"class","flex items-center justify-between"),g(e,"class","glass rounded-xl p-4")},m(o,u){O(o,e,u),r(e,l),r(e,s),c.m(e,null)},p(o,[u]){a===(a=i(o))&&c?c.p(o,u):(c.d(1),c=a(o),c&&(c.c(),c.m(e,null)))},i:me,o:me,d(o){o&&d(e),c.d()}}}function mt(n){try{return new Intl.NumberFormat(void 0,{style:"currency",currency:"USD",maximumFractionDigits:2}).format(n)}catch{return`$${n.toFixed(2)}`}}function Yt(n,e,l){let t=null,s=null,i=!0;return Le(async()=>{l(2,i=!0),l(1,s=null);try{l(0,t=await yt("/analytics/costs/summary"))}catch(a){l(1,s=a.message)}finally{l(2,i=!1)}}),[t,s,i]}class Kt extends we{constructor(e){super(),$e(this,e,Yt,Wt,Ie,{})}}function gt(n){let e,l;return{c(){e=m("div"),l=$(n[1]),this.h()},l(t){e=_(t,"DIV",{class:!0});var s=y(e);l=w(s,n[1]),s.forEach(d),this.h()},h(){g(e,"class","p-3 rounded bg-red-900/40 border border-red-700")},m(t,s){O(t,e,s),r(e,l)},p(t,s){s&2&&M(l,t[1])},d(t){t&&d(e)}}}function Qt(n){var J,z,G,pe,te,ce,ye;let e,l,t,s="Overview",i,a,c,o,u,h,f,D,x,p,v,k,R,b,P,U,V,C,N,q,E,I,A,j,S=n[1]&&gt(n);return o=new xe({props:{title:"Requests / min",value:(J=n[0])==null?void 0:J.requests_per_minute}}),h=new xe({props:{title:"Avg response (ms)",value:(z=n[0])==null?void 0:z.average_response_time}}),D=new xe({props:{title:"Success rate (%)",value:(G=n[0])==null?void 0:G.success_rate}}),p=new xe({props:{title:"Active sessions",value:(pe=n[0])==null?void 0:pe.active_sessions}}),k=new xe({props:{title:"Cost today (USD)",value:(te=n[0])==null?void 0:te.total_cost_today}}),b=new xe({props:{title:"Top errors",value:((ye=(ce=n[0])==null?void 0:ce.top_errors)==null?void 0:ye[0])??"-"}}),C=new Lt({}),E=new Kt({}),A=new Bt({}),{c(){e=m("div"),l=m("div"),t=m("h1"),t.textContent=s,i=L(),S&&S.c(),a=L(),c=m("div"),_e(o.$$.fragment),u=L(),_e(h.$$.fragment),f=L(),_e(D.$$.fragment),x=L(),_e(p.$$.fragment),v=L(),_e(k.$$.fragment),R=L(),_e(b.$$.fragment),P=L(),U=m("div"),V=m("div"),_e(C.$$.fragment),N=L(),q=m("div"),_e(E.$$.fragment),I=L(),_e(A.$$.fragment),this.h()},l(H){e=_(H,"DIV",{class:!0});var F=y(e);l=_(F,"DIV",{class:!0});var Z=y(l);t=_(Z,"H1",{class:!0,"data-svelte-h":!0}),X(t)!=="svelte-hrvmfv"&&(t.textContent=s),i=T(Z),S&&S.l(Z),a=T(Z),c=_(Z,"DIV",{class:!0});var B=y(c);ve(o.$$.fragment,B),u=T(B),ve(h.$$.fragment,B),f=T(B),ve(D.$$.fragment,B),x=T(B),ve(p.$$.fragment,B),v=T(B),ve(k.$$.fragment,B),R=T(B),ve(b.$$.fragment,B),B.forEach(d),P=T(Z),U=_(Z,"DIV",{class:!0});var Y=y(U);V=_(Y,"DIV",{});var se=y(V);ve(C.$$.fragment,se),N=T(se),q=_(se,"DIV",{class:!0});var ne=y(q);ve(E.$$.fragment,ne),ne.forEach(d),se.forEach(d),I=T(Y),ve(A.$$.fragment,Y),Y.forEach(d),Z.forEach(d),F.forEach(d),this.h()},h(){g(t,"class","text-2xl font-semibold mb-6"),g(c,"class","grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"),g(q,"class","mt-4"),g(U,"class","mt-8 grid grid-cols-1 lg:grid-cols-2 gap-4"),g(l,"class","mx-auto max-w-7xl p-6"),g(e,"class","min-h-screen bg-gray-900 text-gray-100")},m(H,F){O(H,e,F),r(e,l),r(l,t),r(l,i),S&&S.m(l,null),r(l,a),r(l,c),he(o,c,null),r(c,u),he(h,c,null),r(c,f),he(D,c,null),r(c,x),he(p,c,null),r(c,v),he(k,c,null),r(c,R),he(b,c,null),r(l,P),r(l,U),r(U,V),he(C,V,null),r(V,N),r(V,q),he(E,q,null),r(U,I),he(A,U,null),j=!0},p(H,[F]){var Ee,De,fe,ae,le,ke,Ce;H[1]?S?S.p(H,F):(S=gt(H),S.c(),S.m(l,a)):S&&(S.d(1),S=null);const Z={};F&1&&(Z.value=(Ee=H[0])==null?void 0:Ee.requests_per_minute),o.$set(Z);const B={};F&1&&(B.value=(De=H[0])==null?void 0:De.average_response_time),h.$set(B);const Y={};F&1&&(Y.value=(fe=H[0])==null?void 0:fe.success_rate),D.$set(Y);const se={};F&1&&(se.value=(ae=H[0])==null?void 0:ae.active_sessions),p.$set(se);const ne={};F&1&&(ne.value=(le=H[0])==null?void 0:le.total_cost_today),k.$set(ne);const be={};F&1&&(be.value=((Ce=(ke=H[0])==null?void 0:ke.top_errors)==null?void 0:Ce[0])??"-"),b.$set(be)},i(H){j||(Q(o.$$.fragment,H),Q(h.$$.fragment,H),Q(D.$$.fragment,H),Q(p.$$.fragment,H),Q(k.$$.fragment,H),Q(b.$$.fragment,H),Q(C.$$.fragment,H),Q(E.$$.fragment,H),Q(A.$$.fragment,H),j=!0)},o(H){ee(o.$$.fragment,H),ee(h.$$.fragment,H),ee(D.$$.fragment,H),ee(p.$$.fragment,H),ee(k.$$.fragment,H),ee(b.$$.fragment,H),ee(C.$$.fragment,H),ee(E.$$.fragment,H),ee(A.$$.fragment,H),j=!1},d(H){H&&d(e),S&&S.d(),de(o),de(h),de(D),de(p),de(k),de(b),de(C),de(E),de(A)}}}function Xt(n,e,l){let t=null,s=null,i=null;async function a(){try{l(0,t=await yt("/analytics/dashboard"))}catch(c){l(1,s=c.message)}}return Le(()=>{a();try{i=It("/analytics/stream",c=>{try{const o=JSON.parse(c.data);o!=null&&o.timestamp&&l(0,t=o)}catch{}})}catch{console.warn("SSE unavailable, falling back to polling");const o=setInterval(a,5e3);et(()=>clearInterval(o))}}),et(()=>{i==null||i.close()}),[t,s]}class tl extends we{constructor(e){super(),$e(this,e,Xt,Qt,Ie,{})}}export{tl as component};
